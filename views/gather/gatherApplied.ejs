<!-- STYLESHEET -->
<link rel="stylesheet" href="/css/gather/gatherApplied.css">

<!--SECTION-->
<section>

	<!-- 전체 틀 -->
    <div class="gather-section">

		<!-- 밥모임 카테고리 -->
        <div class="gather-list">
            <div class="gather-main">
                <a href="/gather">밥모임</a>
            </div>
			<div class="gather-sub">
				<ul class="gather-sub-list">
					<li class="gather-sub-name">
						<a href="/gather/recruiting?countperpage=9&gsort=0">모집중</a>
					</li>
					<li class="gather-sub-name">
						<a href="/gather/completed?countperpage=9&gsort=1">모집완료</a>
					</li>
					<li class="gather-sub-name">
						<span class="font-bold" style="font-weight: 800;">
							<% if(typeof user == 'undefined'){ %>
								<a href="javascript:void(0)" onclick="alert('로그인 후에 이용하실 수 있습니다');">나의 밥모임</a>
							<% } else { %>
								<a href="/gather/mine">나의 밥모임</a>
							<% } %>
						</span>
					</li>
				</ul>
			</div>
        </div>

		<!-- 신청한 모집 부분 -->
		<div class="applied-box">

			<!-- 신청한 모임과 더보기 -->
			<div class="gathering-title">
				<span class="text"> 내가 신청한 모임 </span>
				<!-- <span class="more">
					<a href="/gather/applied?countperpage=9&gsort=1">[더보기]</a>
				</span> -->
			</div>

			<!-- 내가 신청한 모임이 없을 경우만 출력 -->
			<% if (dataList == "" || dataList == false){ %>
				<div class="no-gather">
					아직 신청한 모임이 없어요!
				</div>

			<!-- 내가 신청한 모임이 있을 경우만 -->
			<% } else { %>
				<div class="gather-applied-box">
					<% dataList.forEach((data, index)=>{ %>
						<!-- 리스트 내용 불러오기 -->
						<div class="applied-list-index">
							<div class="applied-index-name">
								<!-- 해당 밥모임 view 페이지로 이동 -->
								<a href="/gather/view?no=<%=data.gathering_id%>">
									<%= data.name %>
								</a>
							</div>
							<div class="applied-index-btn">
								<span class="applied-block-btn">▼</span>
								<span class="applied-none-btn">▲</span>
							</div>
						</div>
						<div class="applied-contents-none">
							<!-- 정보 불러오기 -->
							<div class="applied-content">
								<div class="applied-master">
									👑모임장 : 
									<span>초코케이크</span>
								</div>
								<div class="applied-region">
									모임 지역 : 
									<span>
										<%= data.city%>
										<%= data.district? data.district: ''%>
										<%= data.neighborhood?data.neighborhood: ''%>
									</span>
								</div>

								<div class="applied-spot">
									함께 할 맛집 : 
									<span><%= data.place %></span>
								</div>

								<div class="applied-numbers">
									모임 인원수 (현재 / 총원) : 
									<span>
										<%= data.currentHeadCount %> / <%= data.maximumHeadCount %>
									</span>
								</div>
						
								<div class="applied-deadline">
									모집 마감일 : 
									<span>
										<%= data.createdAt.toISOString().slice(0,4) %>년
										<%= data.createdAt.toISOString().slice(5,7) %>월
										<%= data.createdAt.toISOString().slice(8,10) %>일
									</span>
								</div>

								<div class="applied-intro">
									<div class="applied-intro-title">
										소개글 : 
									</div>
									<div class="applied-intro-text">
										<%= data.description %>
									</div>
								</div>
							</div>
							<div class="applied-align">
								<div class="applied-others">
									<div class="applied-status">
										상태 :&nbsp;
										<% if (stateList[index] == 2) { %>
											<span>요청중</span>
										<% } else if (stateList[index] ==3) { %>
											<span>거절됨</span>
										<% } %>
									</div>
									<div class="applied-cancel">
										<!-- a 태그 주소 /banMember?no=data.gathering_id&memId=user.memId?
										<button>신청취소</button> -->
										<% if (stateList[index] == 2) { %>
											<a href="/gather/banMember?no=<%= data.gathering_id %>&memId=<%= user.mem_id %>&mode=2" target="blankifr">
												<button>신청 취소</button>
											</a>
										<% } else if (stateList[index] ==3) { %>
											<span></span>
										<% } %>
									</div>
									<iframe name="blankifr"></iframe>
								</div>
						
							</div>

						</div>
					<% }) %>
				</div>
			<% } %>

			<!-- 페이지네이션 -->
			<div class="gather-page-box">
				<% if (dataList !== '' && pagination.totalPost !=0){ %>
					<div class="paginationInfo-container">
						<% if (pagination.curSet > 1){ %>    
							<div class="prev-set-button"><a href="/gather/applied?pageno=<%= pagination.startPage-1%>&countperpage=10">&lt;&lt;&nbsp; </a></div>
						<% } %>
						<% if (pagination.pageNo!=1){ %>    
							<div class="prev-button"><a href="/gather/applied?pageno=<%= pagination.pageNo-1%>&countperpage=10">&nbsp;이전&nbsp;</a></div>
						<% } %>
						<div class="number-button-wrapper">
							<% for (var i=pagination.startPage; i < pagination.endPage+1; i++){ %>
								<span class="number-button"> 
									<% if (pagination.pageNo==i){ %>
										<% console.log(i, pagination.pageNo); %>
										<a href="/gather/applied?pageno=<%= i %>&countperpage=10" style="font-weight: 800;"><%= i %></a>
									<% } else{ %>
										<a href="/gather/applied?pageno=<%= i %>&countperpage=10"><%= i %></a>
									<% } %>
								</span>
							<% } %>
						</div>
						<% if (pagination.pageNo != pagination.totalPage){ %>
							<div class="next-button"><a href="/gather/applied?pageno=<%= pagination.pageNo+1%>&countperpage=10"> &nbsp;이후&nbsp;</a></div>
						<% }%>
						<% if (pagination.curSet < pagination.totalSet){ %>
							<div class="next-set-button"><a href="/gather/applied?pageno=<%= pagination.endPage+1%>&countperpage=10">&nbsp;&gt;&gt;</a></div>
						<% }%>
					</div>
				<% } %>
			</div>
			
		</div>
		
    </div>
	
</section>